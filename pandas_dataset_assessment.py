# -*- coding: utf-8 -*-
"""Pandas_Dataset_Assessment.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1vRi0utX1UKqTRFWcKheQmXczHQ0wA5Ej
"""

import numpy as np
import pandas as pd

data=pd.read_csv('Measurement_info.csv', encoding='ISO-8859-10')
data

item=pd.read_csv('Measurement_item_info.csv', encoding='ISO-8859-10')
item

station=pd.read_csv('Measurement_station_info.csv', encoding='ISO-8859-10')
station

sub_item=item[['Item code','Item name']]
sub_item

sub_station=station[['Station code','Station name(district)']]
sub_station

data_i=data.merge(item[['Item code','Item name']],on='Item code',how='left')
data_i.head()

data_s=data_i.merge(station[['Station code','Station name(district)']],
                    on='Station code',how='left')
data_s.head()

data = data_s.drop(['Item code', 'Station code'], axis=1)
data.head()

status_dict={'Instrument status': [0, 1, 2, 4, 8, 9],
             'Status': ['Normal','Need for calibration','Abnormal','Power cut off','Under repair','Abnormal data']}
dictdf=pd.DataFrame(status_dict)
dictdf

data=data.merge(dictdf,on='Instrument status',how='left')
data.head()

data=data.drop(['Instrument status'],axis=1)
data.head()

data['Measurement date'] = pd.to_datetime(data['Measurement date'])

data['Year'] = data['Measurement date'].dt.year
data['Month'] = data['Measurement date'].dt.month
data['Date'] = data['Measurement date'].dt.day
data['Hour'] = data['Measurement date'].dt.hour

data.head()

data=data.drop('Measurement date',axis=1)
data.head()